### 死锁

死锁是指两个或多个进程（线程）在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。简单来说，死锁就是多个进程或线程因为彼此之间相互占有对方需要的资源而陷入了僵持状态。

#### 产生死锁的必要条件

死锁通常发生在以下情况下：（四个必要条件）

1. **互斥条件**：一个资源每次只能被一个进程（线程）访问。
2. **占有且申请条件**：一个进程（线程）已经持有了至少一个资源，但又提出了新的资源请求，而该资源已被其它进程（线程）占有。
3. **不可剥夺条件:** 进程（线程）已获得的资源，在未使用完之前，不能被强行剥夺。
4. **循环等待条件**：若干进程（线程）之间形成一种头尾相接的循环等待资源关系。

当一个系统同时满足以上四个条件时，就可能会发生死锁。如果不加以处理和解决，死锁会导致系统资源的浪费和程序的停止响应。

> 一旦其中的某一个条件破坏，那么死锁的条件也就不成立，就不会发生死锁

#### 死锁的例子

当两个进程分别占有资源A和B，但同时又想请求对方拥有的资源时，就可能发生死锁。

假设现在有两个进程P1和P2，它们需要使用以下资源：

| 进程 | 资源 A | 资源 B |
| :----: | :------: | :------: |
|  P1  |   ✅   |        |
|  P2  |        |   ✅   |

初始时，进程P1已经占有了资源A，而进程P2已经占有了资源B。然而，它们都还需要获取对方拥有的资源才能继续运行。

如果P1此时尝试申请资源B，那么由于该资源已经被P2占用，因此P1会被阻塞等待P2释放资源B。而与此同时，如果P2尝试申请资源A，则也会被阻塞等待P1释放资源A。

这样一来，P1和P2都无法释放自己所持有的资源，也无法获取所需的资源，从而导致了死锁的发生。

#### 解决死锁的方法

死锁是指两个或多个进程在等待另一个进程所持有的资源，从而陷入了一种相互等待的状态，无法继续执行下去。解决死锁的方法主要包括以下几种：

1. **预防死锁**：通过破坏死锁产生的四个必要条件之一来预防死锁。具体方法包括资源分配策略、避免使用不必要的资源、避免持有不同类型的资源等。
2. **避免死锁**：采用安全性算法对资源请求进行动态地检查和分配，以避免死锁的发生。常用的避免死锁算法有银行家算法等。
3. **检测死锁**：通过周期性地对系统中的进程和资源进行检测，判断是否存在死锁情况，并在检测到死锁时采取相应措施。
4. **解除死锁**：当检测到死锁发生时，需要选择一些进程进行抢占，或者撤销一些进程，释放它们所占用的资源，以解除死锁状态。
